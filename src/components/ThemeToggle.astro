<button
  id="theme-toggle"
  aria-label="Toggle dark mode"
  class="text-stone-600 hover:text-stone-900 dark:text-stone-400 dark:hover:text-stone-100 transition-colors"
>
  <span id="theme-icon-light" class="hidden dark:inline">&#9788;</span>
  <span id="theme-icon-dark" class="inline dark:hidden">&#9790;</span>
</button>

<script>
  function initTheme() {
    const toggle = document.getElementById("theme-toggle");
    const saved = localStorage.getItem("theme");
    const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;

    if (saved === "dark" || (!saved && prefersDark)) {
      document.documentElement.classList.add("dark");
    }

    toggle?.addEventListener("click", () => {
      const isDark = document.documentElement.classList.toggle("dark");
      localStorage.setItem("theme", isDark ? "dark" : "light");
    });
  }
  initTheme();
  document.addEventListener("astro:after-swap", initTheme);
</script>
