---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";
import { formatDate } from "../../lib/utils";

const posts = (await getCollection("blog"))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<BaseLayout title="Blog">
  <h1 class="font-serif text-4xl font-bold mb-8">Blog</h1>
  <ul class="space-y-8">
    {
      posts.map((post) => (
        <li>
          <a href={`/blog/${post.id}`} class="group block">
            <h2 class="text-xl font-semibold group-hover:text-accent transition-colors">
              {post.data.title}
            </h2>
            <div class="flex flex-wrap gap-x-4 gap-y-1 text-sm text-stone-500 mt-1">
              <time datetime={post.data.date.toISOString()}>
                {formatDate(post.data.date)}
              </time>
              {post.data.tags.length > 0 && (
                <div class="flex gap-2">
                  {post.data.tags.map((tag: string) => (
                    <span>#{tag}</span>
                  ))}
                </div>
              )}
            </div>
            <p class="text-stone-600 mt-2">{post.data.description}</p>
          </a>
        </li>
      ))
    }
  </ul>
</BaseLayout>
